<div class='main-item'>
    <div class='main-items-item'>
        <div class='items-item-main-inf'>
            <h2><%= itemdata.Title %></h2>
            <div class='items-images'>

                <!-- Item Info -->
                <div class='items-images-main'>
                    <div class='items-images-main-conent'>
                        <span class='items-images-main-text'>Full Item Price</span>
                        <br>
                        <% itemdata.Components.forEach(function(item) { %>
                            <% if (item.name === 'Set') { %>
                                <span class='items-images-main-price'><%= item.avg %></span>
                                <% } %>
                                    <% }); %>
                    </div>
                    <div class='items-images-main-helper'></div>
                    <img src='<%= img %>items/<%= itemdata.Type %>_<%= itemdata.id %>-min.png' alt='<%= itemdata.Title %>'>
                </div>

                <!-- Item Components -->
                <div class='items-images-components'>
                    <div class='items-images-components-part'>


                        <% itemdata.Components.forEach(function(item) { %>
                            <% if (item.name !== 'Set') { %>
                                <!-- Component -->
                                <div class='item-images-components-wr'>
                                    <div class='item-images-components-component'>
                                        <img src='<%= img %>generic/<%= item.name %>-min.png' alt='<%= itemdata.Title %> <%= item.name %>'>
                                    </div>
                                    <div class='items-component-details'>
                                        <h3><%= item.name %></h3>
                                        <h4><%= item.avg %></h4>
                                        <span> | <%= item.comp_val_rt %></span>
                                    </div>
                                </div>
                                <% } %>
                                    <% }); %>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class='main-item'>
    <div class='items-item-stats'>
        <h2 class=' main-item-headline-fix'>Weekly Statistics</h2>
        <div class='main-stats'>
            <div class='items-images'>
                <div class='chart' id="<%= itemdata.id %>"></div>
            </div>
        </div>
    </div>
</div>

<div class='main-item'>
    <div class='items-item-stats'>
        <h2 class=' main-item-headline-fix'>Supply & Demand</h2>
        <div class='items-images items-chart-2nd'>
            <div class='supply-inner-text'>
                <h3>WTB - <em>WTS</em></h3>
                <number>
                    <dem></dem>%/<em><sup></sup>%</em></number>
            </div>
            <div class='chart' id="Demand"></div>
        </div>
    </div>
</div>


<% if (itemdata.SupDem) { %>
    <script>
        $(function () {
            var SupDem = <%- JSON.stringify(itemdata.SupDem)%>;
            var Supply = SupDem[0];
            var Demand = SupDem[1];
            $('sup').html(Supply);
            $('dem').html(Demand);
        });
    </script>
    <% } %>



        <% if (itemdata.id, itemdata.Components) { %>
            <script>
                var ItemName = <%- JSON.stringify(itemdata.id)%>;
                var series = [];
                var compData = <%- JSON.stringify(itemdata.Components) %>;
                Highcharts.setOptions(options);
                var chartdata = {
                    chart: {
                        type: 'areaspline',
                        style: {
                            font: '18px "Raleway", Verdana, sans-serif',
                            color: '#8ea1ac'
                        }
                    },
                    credits: {
                        enabled: false
                    },
                    title: {
                        text: ''
                    },
                    legend: {
                        enabled: true,
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'middle',
                        floating: false,
                        itemMarginBottom: 20,
                        itemStyle: {
                            'color': '#8ea1ac',
                            'font': '16px Raleway'
                        },
                        itemHoverStyle: {
                            color: '#fff'
                        }
                    },
                    xAxis: {
                        gridLineColor: "#69767e",
                        gridLineDashStyle: 'dash',
                        gridLineWidth: 1,
                        minorGridLineColor: "#E0E0E0",
                        minorGridLineDashStyle: "Solid",
                        minorGridLineWidth: 1,
                        categories: [
                '6',
                '5',
                '4',
                '3',
                '2',
                '1',
                'Today'
            ],
                        allowDecimals: false,
                        lineColor: '#8ea1ac',
                        tickColor: 'rgba(0,0,0,0)',
                        startOnTick: true,
                        labels: {
                            style: {
                                color: '#8ea1ac',
                                font: '14px Arial'
                            },
                            formatter: function () {
                                return this.value; // clean, unformatted number for year
                            }
                        }
                    },
                    yAxis: {
                        gridLineColor: "#69767e",
                        gridLineDashStyle: 'dash',
                        gridLineWidth: 1,
                        lineColor: '#8ea1ac',
                        tickColor: 'rgba(0,0,0,0)',
                        title: {
                            text: ''
                        },
                        labels: {
                            style: {
                                color: '#8ea1ac',
                                font: '14px Arial'
                            },
                            formatter: function () {
                                return this.value;
                            }
                        }
                    },
                    tooltip: {
                        style: {
                            color: '#8ea1ac',
                            font: '24px Arial',
                            fontSize: '16px'
                        },
                        pointFormat: '<b>{series.name}</b> at <b>{point.y:,.0f} Platinum'
                    },
                    plotOptions: {
                        series: {
                            connectNulls: true
                        },
                        areaspline: {
                            fillOpacity: 0.05
                        },
                        area: {
                            marker: {
                                enabled: false,
                                symbol: 'circle',
                                radius: 3,
                                states: {
                                    hover: {
                                        enabled: true
                                    }
                                }
                            }
                        }
                    },
                    series: []
                }
                chartdata.series = compData;
                $('#' + ItemName).highcharts(chartdata);
            </script>
            <% } %>










                <% if (itemdata.SupDem, itemdata.SupDemNum) { %>
                    <script>
                        $(function () {
                            var SupDem = <%- JSON.stringify(itemdata.SupDem)%>;
                            var Supply = SupDem[1];
                            var Demand = SupDem[0];
                            var SupDemNum = <%- JSON.stringify(itemdata.SupDemNum)%>;
                            var SupplyNum = SupDemNum[0];
                            var DemandNum = SupDemNum[1];
                            var colors = Highcharts.getOptions().colors,
                                categories = ['Demand', 'Supply'],
                                data = [{
                                        y: Demand,
                                        color: colors[8],
        },
                                    {
                                        y: Supply,
                                        color: colors[0],
                                   }],
                                browserData = [],
                                versionsData = [],
                                i,
                                j,
                                dataLen = data.length,
                                drillDataLen,
                                brightness;
                            // Build the data arrays
                            for (i = 0; i < dataLen; i += 1) {
                                // add browser data
                                browserData.push({
                                    name: categories[i],
                                    y: data[i].y,
                                    color: data[i].color
                                });
                            }
                            // Create the chart
                            $('#Demand').highcharts({
                                credits: {
                                    enabled: false
                                },
                                chart: {
                                    type: 'pie',
                                    categories: ['WTS', 'WTB']
                                },
                                title: {
                                    text: ''
                                },
                                plotOptions: {
                                    pie: {
                                        allowPointSelect: true,
                                        cursor: 'pointer',
                                        dataLabels: {
                                            enabled: false,
                                        },
                                        borderWidth: 0,
                                    }
                                },
                                tooltip: {
                                    style: {
                                        color: '#8ea1ac',
                                        font: '24px Arial',
                                        fontSize: '16px'
                                    },
                                    useHTML: true,
                                    formatter: function () {
                                            if (this.point.name == 'Demand') {
                                                return '<b>Supply</b>:' + SupplyNum + ' Offers';
                                            } else {
                                                if (this.point.name == 'Supply') {}
                                                return '<b>Demand</b>:' + DemandNum + ' Offers';
                                            }
                                        }
                                        //pointFormat: '<b>'+ this.point.name +'</b> at <b>{point.y:,.0f} Platinum'
                                },
                                series: [{
                                    name: 'Supply/Demand',
                                    data: browserData,
                                    size: '100%',
                                    innerSize: '95%',
                                    dataLabels: {
                                        formatter: function () {
                                            return this.y > 5 ? this.point.name : null;
                                        },
                                        color: '#ffffff',
                                        distance: -30
                                    }
                                }]
                            });
                        });
                    </script>
                    <% } %>
